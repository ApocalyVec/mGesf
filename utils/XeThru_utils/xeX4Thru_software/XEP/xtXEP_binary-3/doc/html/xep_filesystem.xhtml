<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>XeThru Embedded Platform - XEP: XEP file system</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <!-- Platform title -->
    <div class="page-title-bar container-fluid">
      <div id="projectalign" class="row">
        <div id="projectname" class="col-sm-12">XeThru Embedded Platform - XEP
          &#160;<span id="projectnumber">3.4.7</span>
        </div>
        <div id="projectbrief" class="col-sm-12">Embedded platform for XeThru firmware products</div>
      </div>
    </div>
    <div class="topbar">
      <div class="container">
        <div id="titlearea">
          <div class="xethru-logo">
            <img src="xethru-logo_220x55HD.png" alt="Novelda XeThru web site" id="logo-image" />
          </div>
        </div>
        <!-- end header part -->
        <!-- Generated by Doxygen 1.8.12 -->
        <!--BEGIN MAIN-NAV AND SEARCHENGINE-->
        <div id="main-nav"></div>
        <!--END MAIN-NAV AND SEARCHENGINE-->
      </div>
    </div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">XEP file system </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>XEP File System (XFS) allows for storing data in the embedded flash of the MCU.</p>
<p>It only supports the most basic functionality to be very light-weight. Multiple files of different sizes can be created and be stored in flash. The contents can be changed at a later time, but the size of the file can not be changed. However, a new file with the new size can be created and the old one deleted.</p>
<p>Each file is identified with a type that is defined in <a class="el" href="xtfile_8h.xhtml#a6331c0367dfd861a0b449c37862d3854">xtfile_types_t</a>, and an identifier. The type/identifier combination must be unique. To avoid collisions with XEP defined types, all user defined functions are defined from 0x80000000 and up. Functions to search for files are available, both for all files and by specified type.</p>
<p>The size of the file system is defined by overriding the function <a class="el" href="xep__application_8c.xhtml#aefe7169e7dda92dc0f1f65145d360839">xep_app_storage_section</a>. By default, no memory is reserved. Flash page size determines the minimum allocation unit, and is automatically detected through the HAL layer.</p>
<p><a class="el" href="xtfile_8h.xhtml">xtfile.h</a> file contains the interface that should be used to access the file system.</p>
<p>Example of using the file system: </p><pre class="fragment">#include "xtfile.h"

static void task_application(void *pvParameters)
{
    // Your init code

    // Create file
    uint32_t status;
    void* handle;

    char text_data[] = "This is some data.";
    status = xtfile_create_and_open(&amp;handle, XTFILE_TYPE_USER_DEFINED | XTFILE_TYPE_LOG, 0, text_data, sizeof(text_data));
    if (status != XTFILE_OK)
    {
        // Error handling...
    }
    status = xtfile_close(handle); 

    // Search for files of given type
    uint32_t identifiers[10];
    uint32_t size = 0;
    status = xtfile_search(XTFILE_TYPE_USER_DEFINED | XTFILE_TYPE_LOG, identifiers,
                            10, &amp;size);

    if (size &gt; 0)
    {
        status = xtfile_open(&amp;handle, XTFILE_TYPE_USER_DEFINED | XTFILE_TYPE_LOG, identifiers[0]);
        void* data = 0;
        uint32_t data_size = 0;
        status = xtfile_get_buffer(handle, &amp;data, &amp;data_size);

        // Do something with the data

        status = xtfile_close(handle); 

        status = xtfile_delete(XTFILE_TYPE_USER_DEFINED | XTFILE_TYPE_LOG, identifiers[0]);
    }

    // The task loop
    for(;;)
    {
        // Your task code
    }
}
</pre><p>Note that each write to flash will impose a wear on the embedded flash. This means that the firmware should not write too often, as this will eventually wear out the embedded flash. There is no wear-leveling implemented. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.12-->
<!-- start footer part -->
<hr class="footer"/>
 <address class="footer">
 Copyright &copy; 2016 Novelda AS - <a href="http://www.xethru.com">www.xehtru.com</a><br />
 <small>
  Generated by &#160;<a href="http://www.doxygen.org/index.html">
  <img class="footer" src="doxygen.png" alt="doxygen"/>
  </a> 1.8.12
 </small>
 </address>
</body>
</html>
